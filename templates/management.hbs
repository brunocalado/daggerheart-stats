<div class="dhs-management-wrapper">
    <!-- TABS NAVIGATION -->
    <div class="dhs-tabs">
        <button type="button" class="dhs-tab-btn active" data-tab="user-management">User Management</button>
        <button type="button" class="dhs-tab-btn" data-tab="date-management">Date Management</button>
        <button type="button" class="dhs-tab-btn" data-tab="tags-management">Tags</button>
    </div>

    <!-- TAB 1: USER MANAGEMENT -->
    <div id="tab-user-management" class="tab-content active">
        <div class="management-section">
            
            <div class="user-list">
                {{#each users}}
                <div class="user-row">
                    <span class="user-name">{{this.name}}{{#if this.isCurrentGM}} <i class="fas fa-crown gm-crown"></i>{{/if}}</span>
                    <div class="user-actions">
                        {{#if this.isGM}}
                        {{#if ../hasMultipleGMs}}
                        <button type="button" class="action-btn btn-gm {{#if this.isCurrentGM}}btn-current-gm{{/if}}" data-action="setCurrentGM" data-user="{{this.name}}" data-tooltip="Set as Current GM">
                            <i class="fas fa-crown"></i> Current GM
                        </button>
                        {{/if}}
                        {{/if}}

                        <button type="button" class="action-btn btn-visibility {{#if this.isHidden}}btn-hidden{{/if}}" data-action="toggleVisibility" data-user="{{this.name}}" data-tooltip="Toggle Visibility in Statistics">
                            <i class="fas {{#if this.isHidden}}fa-eye-slash{{else}}fa-eye{{/if}}"></i> Show
                        </button>

                        <button type="button" class="action-btn btn-export" data-action="exportData" data-user="{{this.name}}" data-tooltip="Export Data">
                            <i class="fas fa-file-export"></i> Export
                        </button>

                        <button type="button" class="action-btn btn-import" data-action="importData" data-user="{{this.name}}" data-tooltip="Import Data (Overwrites)">
                            <i class="fas fa-file-import"></i> Import
                        </button>

                        <button type="button" class="action-btn btn-delete" data-action="deleteData" data-user="{{this.name}}" data-tooltip="Delete All Data">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                {{/each}}
            </div>

            <!-- Global Wipe Button -->
            <div class="wipe-all-container">
                <button type="button" class="btn-wipe-all" data-action="fullWipe">
                    <i class="fas fa-radiation"></i> WIPE ALL DATA
                </button>
            </div>
        </div>
    </div>

    <!-- TAB 2: DATE MANAGEMENT -->
    <div id="tab-date-management" class="tab-content">
        <div class="management-section">
            
            <!-- UPDATED LAYOUT: Space Between for Left/Right alignment -->
            <div class="date-controls" style="display: flex; justify-content: space-between; align-items: center; gap: 15px; width: 100%;">
                
                <!-- Left Side: User Select -->
                <div style="display: flex; align-items: center; gap: 10px;">
                    <label>Select User:</label>
                    <select id="select-usertomanage" name="usertomanage" class="compact-select"> 
                        {{{whichuser}}}
                    </select>
                </div>

                <!-- Right Side: Instruction Text -->
                <div style="font-size: 0.9em; color: #FFFFFF; font-style: italic; white-space: nowrap;">
                    Click a date below to delete specific session data:
                </div>
            </div>
            
            <div id="list-dates">
                <!-- Buttons injected via JS into .dates-list-container -->
            </div>
        </div>
    </div>

    <!-- TAB 3: TAGS MANAGEMENT -->
    <div id="tab-tags-management" class="tab-content">
        <div class="management-section">

            <div class="tags-container">
                {{#each tags}}
                <div class="tag-row">
                    <div class="tag-label" data-tooltip="Default: {{this.default}}">
                        {{this.default}}
                    </div>
                    <input type="text" name="{{this.key}}" class="tag-input" value="{{this.current}}" placeholder="{{this.default}}">
                </div>
                {{/each}}
            </div>

            <div class="tags-actions">
                <button type="button" class="action-btn btn-reset btn-wide" data-action="resetTags">
                    <i class="fas fa-undo"></i> Reset
                </button>
                <button type="button" class="action-btn btn-save btn-wide" data-action="saveTags">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </div>
    </div>
</div>